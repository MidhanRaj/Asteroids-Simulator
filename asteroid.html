<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asteroid Impact Simulator - Realistic Edition</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body {
    margin: 0;
    display: flex;
    height: 100vh;
    font-family: 'Poppins', sans-serif;
    background: #0b0c10;
    color: white;
    overflow: hidden;
  }
  #map {
    flex: 2;
    height: 100%;
  }
  .info-panel {
    flex: 1;
    overflow-y: scroll;
    padding: 20px;
    background: #141414;
    border-left: 2px solid #222;
  }
  h2 {
    color: #ff6b00;
  }
  .section {
    margin-bottom: 60px;
    padding: 15px;
    background: #1e1e1e;
    border-radius: 10px;
    transition: transform 0.3s;
  }
  .section.active {
    transform: scale(1.03);
    box-shadow: 0 0 20px rgba(255,107,0,0.4);
  }
  .label {
    background: rgba(0,0,0,0.6);
    color: white;
    padding: 3px 8px;
    border-radius: 5px;
    font-size: 12px;
  }
</style>
</head>
<body>

<div id="map"></div>

<div class="info-panel" id="infoPanel">
  <h2>Asteroid Impact Results</h2>
  <div class="section" id="crater">
    <h3>üåã Crater</h3>
    <p id="craterText">Click anywhere on the map to launch an asteroid.</p>
  </div>
  <div class="section" id="fireball">
    <h3>üî• Fireball</h3>
    <p id="fireballText"></p>
  </div>
  <div class="section" id="shockwave">
    <h3>üí• Shockwave</h3>
    <p id="shockwaveText"></p>
  </div>
  <div class="section" id="wind">
    <h3>üå™Ô∏è Wind Blast</h3>
    <p id="windText"></p>
  </div>
  <div class="section" id="earthquake">
    <h3>üåé Earthquake</h3>
    <p id="earthquakeText"></p>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([0, 0], 2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 7,
  minZoom: 2,
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

let circles = {};
let labels = {};

// üå† Material properties (kg/m¬≥)
const materials = {
  iron: 7800,
  stone: 3000,
  carbon: 1500,
  comet: 600
};

// Default asteroid
const asteroid = {
  diameter: 1000, // meters
  velocity: 17000, // m/s
  density: materials.iron,
  angle: 45 // degrees
};

// Utility function for circle creation
function drawCircle(lat, lon, radius, color, name) {
  if (circles[name]) map.removeLayer(circles[name]);
  if (labels[name]) map.removeLayer(labels[name]);
  circles[name] = L.circle([lat, lon], {
    radius: radius * 1609, // miles ‚Üí meters
    color: color,
    weight: 2,
    fillOpacity: 0.1
  }).addTo(map);
  labels[name] = L.marker([lat, lon], {
    icon: L.divIcon({
      className: 'label',
      html: `${name.charAt(0).toUpperCase() + name.slice(1)} Zone`
    })
  }).addTo(map);
}

// üåç Impact simulation
map.on('click', (e) => {
  const lat = e.latlng.lat;
  const lon = e.latlng.lng;

  const r = asteroid.diameter / 2;
  const m = (4/3) * Math.PI * Math.pow(r, 3) * asteroid.density;
  const E = 0.5 * m * Math.pow(asteroid.velocity, 2); // Joules
  const Egt = E / 4.184e15; // Convert to gigatons TNT

  const craterMiles = (Math.pow(E, 1/4) / 800).toFixed(1);
  const craterDepthFt = (craterMiles * 118).toFixed(0);

  const fireballMiles = (Math.pow(E, 1/4) / 600).toFixed(1);
  const shockwaveMiles = (craterMiles * 10).toFixed(0);
  const windMiles = (craterMiles * 12).toFixed(0);
  const quakeMiles = (craterMiles * 20).toFixed(0);

  // Draw all zones
  drawCircle(lat, lon, craterMiles, "orange", "crater");
  drawCircle(lat, lon, fireballMiles, "red", "fireball");
  drawCircle(lat, lon, shockwaveMiles, "yellow", "shockwave");
  drawCircle(lat, lon, windMiles, "blue", "wind");
  drawCircle(lat, lon, quakeMiles, "gray", "earthquake");

  map.setView([lat, lon], 6);

  // Display info
  document.getElementById("craterText").innerHTML = `
    ${craterMiles} mile wide crater<br>
    Crater is ${craterDepthFt} ft deep<br>
    Impact speed: ${(asteroid.velocity * 2.237).toFixed(0)} mph<br>
    Energy released: ${Egt.toFixed(1)} Gigatons TNT
  `;
  document.getElementById("fireballText").innerHTML = `
    ${fireballMiles} mile wide fireball<br>
    Fires ignited up to ${(fireballMiles * 4.5).toFixed(0)} miles away
  `;
  document.getElementById("shockwaveText").innerHTML = `
    ${shockwaveMiles} mile radius shockwave<br>
    Air pressure up to 240 dB<br>
    Buildings collapse within ${(shockwaveMiles / 2).toFixed(0)} miles
  `;
  document.getElementById("windText").innerHTML = `
    Peak wind speeds ${(Math.pow(Egt, 0.3) * 300).toFixed(0)} mph<br>
    Wind blast radius ${windMiles} miles
  `;
  document.getElementById("earthquakeText").innerHTML = `
    Estimated magnitude ${(0.67 * Math.log10(E) - 5.87).toFixed(1)} earthquake<br>
    Felt up to ${quakeMiles} miles away
  `;
});

// Scroll-driven map updates
const sections = document.querySelectorAll('.section');
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      sections.forEach(s => s.classList.remove('active'));
      entry.target.classList.add('active');
      const id = entry.target.id;
      Object.keys(circles).forEach(k => {
        circles[k].setStyle({opacity: k === id ? 1 : 0.2});
      });
    }
  });
}, { threshold: 0.5 });
sections.forEach(section => observer.observe(section));
</script>
</body>
</html>

